$card-space: 3px;

html,
body {
    height: 100%;
}

body {
    margin: 0;
    display: grid;
    place-items: center;
    perspective: 1000px;
    overflow-x: hidden;
}

.board {
    --card-width: min(300px, 30vmin);
    display: flex;
    align-items: center;
    width: calc(4 * var(--card-width));
    transform: rotateZ(90deg);
    transform: rotateX(40deg);
    margin: 1rem 3rem;
}

.board,
.card,
.wrapper,
.content {
    transform-style: preserve-3d;
}

.card {
    --duration: 1200ms;
    position: sticky;
    top: 50%;
    width: var(--card-width);
    aspect-ratio: 20/29;
    outline: none;
    border: none;
    cursor: pointer;
    padding: 0;
    background-color: transparent;
    transition: all 200ms;
    pointer-events: none;
    margin-top: 20em;
    animation: flip-card 1s ease-in-out forwards;

    @each $i in (1, 2, 3) {
        &:nth-child(#{$i}) {
            transform: translateZ($i * $card-space);
        }
    }
}

.wrapper {
    pointer-events: initial;
    display: block;
    position: relative;
    height: 100%;
    transition: all var(--duration) ease-out;
    transform-origin: 200% 50%;
}

.content {
    display: block;
    height: 100%;
    transition: all var(--duration);
}

.face {
    transition: transform calc(var(--duration) * 3 / 4);
    transition-delay: calc(var(--duration) / 6);
    position: absolute;
    inset: 0;
    backface-visibility: hidden;
    border-radius: calc(var(--card-width) / 20);
    background-size: cover;
    background-position: center;
    background-color: white;
}

.front {
    transform: rotateZ(0.5turn) rotateY(-0.5turn);
    border-width: 1px 0px;
    border-color: black;
    border-style: solid;

    .card:nth-of-type(1) & {
        background-image: url("https://upload.wikimedia.org/wikipedia/commons/thumb/1/19/English_pattern_ace_of_spades.svg/1024px-English_pattern_ace_of_spades.svg.png");
    }

    .card:nth-of-type(2) & {
        background-image: url("https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/English_pattern_2_of_spades.svg/1024px-English_pattern_2_of_spades.svg.png");
    }

    .card:nth-of-type(3) & {
        background-image: url("https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/English_pattern_3_of_spades.svg/1024px-English_pattern_3_of_spades.svg.png");
    }

    .card:nth-of-type(4) & {
        background-image: url("https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/English_pattern_jack_of_spades.svg/216px-English_pattern_jack_of_spades.svg.png");
    }
}

.back {
    background-image: url("https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTkKnlurWcUYrlDbGvf8IUz6rLX7oX1hHt7FW_6e4vNOwFfPhmPURXxGK45qVAqW7dtxsY&usqp=CAU");
    border: 1px solid black;
}

.card.flipped {
    @each $i in (1, 2, 3) {
        &:nth-child(#{$i}) {
            transform: translateZ((5 - $i) * $card-space);
        }
    }

    .wrapper {
        transform: rotateY(0.5turn);
    }

    .content {
        transform: rotateX(-0.5turn) rotateY(1.5turn);
    }
}

@keyframes flip-card {
    0% {
        transform: rotateY(0);
    }
    100% {
        transform: rotateY(180deg);
    }
}
